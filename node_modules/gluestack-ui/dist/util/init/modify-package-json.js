"use strict";
const path = require('path');
const fs = require('fs');
const updatePackageJson = (fileDir) => {
    var _a, _b, _c, _d;
    const filePath = path.join(fileDir, 'package.json');
    const data = require(filePath);
    if (!((_b = (_a = data === null || data === void 0 ? void 0 : data.scripts) === null || _a === void 0 ? void 0 : _a.postinstall) === null || _b === void 0 ? void 0 : _b.includes('patch-package'))) {
        const command = ((_c = data === null || data === void 0 ? void 0 : data.scripts) === null || _c === void 0 ? void 0 : _c.postinstall)
            ? 'patch-package && ' + ((_d = data === null || data === void 0 ? void 0 : data.scripts) === null || _d === void 0 ? void 0 : _d.postinstall)
            : 'patch-package';
        const newData = Object.assign(Object.assign({}, data), { scripts: Object.assign(Object.assign({}, data === null || data === void 0 ? void 0 : data.scripts), { postinstall: command }) });
        fs.writeFile(filePath, JSON.stringify(newData, null, 2), (err) => {
            if (err)
                throw err;
        });
    }
};
module.exports = { updatePackageJson };
